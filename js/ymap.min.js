"use strict";function init(){myMap=new ymaps.Map("map",{center:[43.121116074495795,131.912434],zoom:15,controls:["zoomControl","fullscreenControl"]}),print_all_mags()}function print_all_mags(){districtCollections=[];for(var t=0,e=markMags.length;t<e;t++)for(var i=0,s=markMags[t].mags.length;i<s;i++)myPlacemark=new ymaps.Placemark(markMags[t].mags[i].coordinates,{balloonContent:"<div class='map_info'><h2>"+markMags[t].mags[i].name+"</h2><div class='adr'>"+markMags[t].mags[i].adr+"</div><div class='time'>"+markMags[t].mags[i].time+"</div></div>"},{iconLayout:"default#image",iconImageHref:"img/swg/map-marker.svg",iconImageSize:[28,28],iconImageOffset:[-10,-28],iconMaxHeight:28,iconMaxWidth:28}),districtCollections[districtCollections.length]=myPlacemark;for(var t=markMags[0].mags.length;t<districtCollections.length;t++)myMap.geoObjects.add(districtCollections[+t])}ymaps.ready(init);var myMap,myPlacemark,districtCollections;$(document).ready(function(){$("section.map .tab.tab2").on("click",function(){$("section.map .tab").removeClass("active"),$(this).addClass("active"),$("section.map .mag_list").removeClass("active"),print_all_mags()});for(var t,e=0,i=0;i<=markMags.length;i++)if(t=markMags[i],0===i)$(".map_header").append('<div class="tab tab1" data-tab="megatab1" data-collection="0">Фирменный магазин <div class="cnt">'+t.mags.length+"</div></div>"),$(".scroll_wrap").append('<ul class="mag_list active" data-collection="'+markMags.length+'" id="allTab"></ul>');else if(i===markMags.length)$(".map_header").append('<div class="tab tab2 active"  data-tab="allTab">Магазины города <div class="cnt">'+e+"</div></div>"),$(".district").append('<li class="active" data-tab="allTab" data-collection="'+i+'"><span>Все на карте<div class="cnt">'+e+"</div></span></li>");else{$(".district").append('<li data-tab="tab'+i+'" data-collection="'+i+'"><span>'+t.district+'<div class="cnt">'+t.mags.length+"</div></span></li>"),$(".scroll_wrap").append('<ul class="mag_list" data-collection="'+i+'" id="tab'+i+'"></ul>');for(var s=0;s<t.mags.length;s++)e++,$(".scroll_wrap").children(":last-child").append('<li>\t\t\t\t\t\t\t\t<div class="name" data-id="'+t.mags[s].id+'" >'+t.mags[s].name+'</div>\t\t\t\t\t\t\t\t<span class="adr">'+t.mags[s].adr+'</span>\t\t\t\t\t\t\t\t<span class="time">'+t.mags[s].time+"</span>\t\t\t\t\t\t\t</li>"),$(".scroll_wrap").children('[id="allTab"]').append('<li>\t\t\t\t\t\t\t\t<div class="name" data-id="'+t.mags[s].id+'" >'+t.mags[s].name+'</div>\t\t\t\t\t\t\t\t<span class="adr">'+t.mags[s].adr+'</span>\t\t\t\t\t\t\t\t<span class="time">'+t.mags[s].time+"</span>\t\t\t\t\t\t\t</li>")}$("section.map .district li").on("click",function(){$(this).parents("ul").children("li").removeClass("active"),$(this).addClass("active"),$("section.map .mag_list").removeClass("active"),$("#"+$(this).attr("data-tab")).addClass("active"),myMap.geoObjects.removeAll();for(var t=$("#"+$(this).attr("data-tab")).children(":first-child").children(".name").attr("data-id"),e=$("#"+$(this).attr("data-tab")).children(":last-child").children(".name").attr("data-id");+t<=+e;t++)myMap.geoObjects.add(districtCollections[+t+markMags[0].mags.length-1])}),$("section.map .mag_list .name").on("click",function(){$(this).parents("ul").children("li").removeClass("active"),$(this).parents("li").addClass("active"),myMap.geoObjects.get($(this).attr("data-id")-$(this).parents("ul").children(":first-child").children(".name").attr("data-id")).balloon.open()}),$("section.map .tab.tab1").on("click",function(){$("section.map .tab").removeClass("active"),$(this).addClass("active"),$("section.map .mag_list").removeClass("active"),$("section.map .mag_list#"+$(this).attr("data-tab")).addClass("active"),myMap.geoObjects.removeAll();for(var t=$("#"+$(this).attr("data-tab")).children(":first-child").children(".name").attr("data-id"),e=$("#"+$(this).attr("data-tab")).children(":last-child").children(".name").attr("data-id");+t<=+e;t++)myMap.geoObjects.add(districtCollections[+t+markMags[0].mags.length-1])}),$("section.map .tab.tab2").on("click",function(){$("section.map .tab").removeClass("active"),$(this).addClass("active"),$("section.map .mag_list").removeClass("active"),$("section.map .mag_list#"+$(this).attr("data-tab")).addClass("active"),print_all_mags()})});